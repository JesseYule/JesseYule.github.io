<!DOCTYPE html>
<!-- saved from url=(0029)https://carrac.co.jp/service/ -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Jesse Yule's Blog</title>
    <meta name="viewport" content="width=device-width">

    <style>.l-page { visibility: hidden; }</style>
    <link rel="stylesheet" as="style" href="../../css/main/main.min.css">
    <link rel="apple-touch-icon" sizes="180x180" href="https://carrac.co.jp/img/common/app_icon.png">

    <link rel="stylesheet" href="../../css/menu/common.css" media="all">
    <link rel="stylesheet" href="../../css/menu/home.css" media="all">
    <script type="text/javascript" async="" src="../../css/menu/analytics.js"></script>
    <script async="" src="../../css/menu/js"></script>

    <!-------------------------matjax------------------------------>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
    <!---------------------------------------------------------------->

    <meta name="theme-color" content="#ffffff">

    <script type="text/javascript" async="" src="../../css/main/analytics.js"></script><script async="" src="../../css/main/gtm.js"></script><script>
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-KHDRBVP');
    </script>
    <!-- End Google Tag Manager -->
  </head>
  <body style="font-family: 等线, 等线 Light,'微软雅黑 Light',Helvetica Neue, Helvetica, Arial, PingFang SC; font-weight: lighter ;word-break: break-all;background-color: #323638 ">
    <!-- Google Tag Manager (noscript) -->
    <noscript>
      &lt;iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHDRBVP"
      height="0" width="0" style="display:none;visibility:hidden"&gt;
      &lt;/iframe&gt;
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <div class="l-page" data-page-id="service">
      <!-- Start to define the global header.-->
      <div class="l-gh"></div>
      <!-- End to define the global header.-->




      <div class="l-contents">
        <!-- Start to define the main content.-->

          <header class="st-hdr" id="js-hdr">
              <div class="hdr-bar m-row m-row--jc--spacebetween m-row--ai--center">

              </div>

          </header>

          <button class="trigger" id="js-trigger"><span></span><span></span><span></span></button>



          <nav class="overlay-navigation" style="color: #eeeeee">
              <div class="overlay-navigation__inner m-row">
                  <div class="overlay-navigation__block">
                      <ul class="sitemap m-row m-row--fw--wrap">

                                                   <li class="sitemap__unit"><a href="../../index.html">Home</a></li>

                          <li class="sitemap__unit"><a href="../../about/about.html">About</a></li>

                          <li class="sitemap__unit"><a href="../../programming/java1.html">Java</a></li>



                          <li class="sitemap__unit"><a href="../../math/all1.html">Mathematics</a></li>

                          <li class="sitemap__unit"><a href="../../naturallanguage/all1.html">Natural Language</a></li>

                          <li class="sitemap__unit"><a href="../../machinelearning/ml1.html">Machine Learning</a></li>

<li class="sitemap__unit"><a href="../../articles/all1.html">Others</a></li>

                      </ul>

                  </div>
                  <div class="sns"><h2 class="overlay-navigation__siteID"><img src="../../css/menu/img_siteID-m.svg"
                                                                               alt=""></h2></div>
              </div>
          </nav>




          <div class="p-lower">
          <div class="c-red-line c-slide-in u-animdel-100"></div>
          <h2 class="p-lower__title-en c-slide-in u-animdel-100">集成学习与boosting</h2>

		  
		   <div class="p-lower-kv">
            <div class="p-lower-kv__text">
              <div class="p-lower-kv__subtitle"> </div>

                <div class="p-lower-kv__outline p-lower-kv__outline--col2">之前多次提到，通过构建多个学习器进行综合分析完成学习任务，这种思想就是集成学习。</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><br></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">学习器可以是同一种，也可以是不同的，比如随机森林就都是由决策树构成的，有时候可能也会把决策树和其他模型混合在一起。</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><br></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">如果我们只是单纯把模型堆在一起，那么模型的上限也就只能是其中最好的模型，所以我们应该遵循什么规则呢，这里不卖关子，答案就是模型之间性能差异不能过大且具有多样性。</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><br></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">一般来说，整个集成学习模型，会根据里面的各个个体学习器的结果，进行简单投票法，哪个结果是由最多学习器得到的，这个结果就作为整个模型的最终输出。而我们希望学习器性能好且具有多样性，其实可以从这个角度来思考，性能好是当然的，可是为什么需要多样性，假如每个模型都十分接近，比如说都是一个节点十分相似的决策树，那么构成的随机森林和单纯用一个决策树还会有区别吗，为什么随机森林里面要有多个决策树，其实就是希望每个决策树都能从不同的角度出发分析问题，得出答案，当每个决策树分析的侧重点不同，得到的答案仍然非常接近，这时候是不是就更有理由认为这个就是正确答案了。</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><br></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">从另一个角度来说，还是深度学习中的transformer这个例子，为什么attention需要multi-head，说到底还是希望模型能提取出多个特征，综合多个角度进行分析，这样模型的鲁棒性就会更强，准确率更高，这些改进，其实本质上都是集成学习的思想。</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><br></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">加下来我们再来看看什么是boosting，首先，集成学习可以分为两类，一类是学习器之间具有依赖关系的，就是不同的学习器可以相互交流改进，还有一种就是不存在依赖关系，各学各的，前者的代表就是boosting，后者的代表就是bagging和随机森林。</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><br></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">boosting的基本思路就是，先从初始训练集训练出一个基学习器，然后根据基学习器的表现对训练样本的分本进行调整，使得之前训练出错的样本再之后的训练中得到更多的关注，然后用经过调整的训练集训练下一个基学习器，直到训练事先预定的次数，再将所有得到的基学习器进行加权结合。</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><br></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">关于boosting算法的细节，其实还是有些地方没有说清楚，比如基学习器的表现是通过什么反映，样本的权重是怎么更新的，对基学习器进行加权结合，权重是怎么计算，boost家族中的不同算法对这些问题提出了不同的解答方案，现在主要来看看比较经典的adaboost是怎么解决的。</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><br></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">以分类问题为例，假设我们有数据：</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><section style="text-align: center; margin:0 auto">$$T = \{(x_1, y_1), ..., (x_n, y_n)\}$$</section></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">训练集的权重为：</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><section style="text-align: center; margin:0 auto">$$D(K) = (w_{k1}, w_{k2}, ..., w_{kn})$$</section></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">这个权重是不断变化的，一开始，权重初始化全为1/m。然后正如boosting的思想，用基学习器进行训练，通过训练误差反映基学习器G_k的表现：</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><section style="text-align: center; margin:0 auto">$$e_k = \sum_{i=1}^m w_{ki}I(G_k(x) \neq y_i)$$</section></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">可以看到，误差主要是通过没有正确分类的样本的权重来反映的，这也是我们一开始设定每个样本的权重的目的，如果一个样本经过多个基学习器依然没有成功分类，它的权重就会不断上升，接下来，我们再看看样本的权重是怎样变化的：</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><section style="text-align: center; margin:0 auto">$$w_{k+1, i} = \frac{w_{ki}}{Z_K}exp(-\alpha_k y_i G_k(x_i))$$</section></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">其中，Z_K是规范化因子，其实就是归一化处理：</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><section style="text-align: center; margin:0 auto">$$Z_k = \sum_{i=1}^m w_{ki} exp(-\alpha_k y_i G_k(x_i))$$</section></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">alpha_k则是基学习器的权重：</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><section style="text-align: center; margin:0 auto">$$\alpha_k = \frac{1}{2} log\frac{1-e_k}{e_k}$$</section></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">这个权重也是最后用来对所有基学习器进行加权结合的，可以看出权重和误差有关，误差越小权重越大。</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><br></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">最后，adaboost还会把一轮训练错误的数据，和原始数据集合并用于下一轮的训练，所以这时候训练数据中错误训练的数据所占的比重就会增大。</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><br></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">所以adaboost所做的，就是告诉boost算法，如何评价一个基学习器的性能，如何确定每个样本的权重以及这些权重有什么作用，如何更新样本的分布。</div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2"><br></div>
                <div class="p-lower-kv__outline p-lower-kv__outline--col2">最后说一下adaboost的优缺点，首先是优点，adaboost分类精度高，可使用各种回归分类模型作为基学习器，不容易过拟合，但是，adaboost对异常样本敏感，异常样本在训练中可能会得到较高的权重，影响模型的性能。</div>




            </div>
          </div>
		  



        </div>

        <!-- End to define the main content.-->
      </div>


    </div>
    <script src="../../css/main/main.min.js" async=""></script>

    <script type="text/javascript" defer=""
            src="../../css/menu/autoptimize_73b1aaeb49de3f7372d04614ffa9ecd3.js"></script>

</body></html>